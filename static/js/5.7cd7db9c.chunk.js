(this["webpackJsonpthree-react-sandbox"]=this["webpackJsonpthree-react-sandbox"]||[]).push([[5,8],{39:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var a=n(0),r=n.n(a),o=(n(45),function(e){var t=e.sample;return console.log("Sample: %s %s",t.name,t.caseNb?"#"+t.caseNb:""),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"overlay",id:"info"},r.a.createElement("span",null,t.name)))}),c=function(e){var t=e.items,n=e.current,a=e.onSelect;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"overlay inputBtn",id:"caseSelector"},r.a.createElement("select",{id:"testCases",value:n,onChange:function(e){return a(e.target.value)}},Object.keys(t).map((function(e){return r.a.createElement("option",{key:e,value:e},t[e])})))))}},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(16),r=n(15),o=n(49),c=Object(o.a)((function(e,t){return{time:{custom:new Date},controls:{},setTime:function(n){e(Object(a.a)({},t(),{time:{custom:n}}))},setControls:function(n){return e(Object(a.a)({},t(),{controls:n}))}}})),l=Object(r.a)(c,1)[0]},42:function(e,t,n){"use strict";n.r(t),n.d(t,"Wrapper",(function(){return O})),n.d(t,"Controls",(function(){return y})),n.d(t,"MoveCtrl",(function(){return w})),n.d(t,"Lights",(function(){return S})),n.d(t,"Helpers",(function(){return C}));var a,r=n(15),o=n(0),c=n.n(o),l=n(38),i=n(41),u=n(43),s=n.n(u),m=n(44),f=n.n(m),h=new l.TextureLoader,d=function(e,t){return h.load(e,(function(e){return e.wrapS=l.RepeatWrapping,e.wrapT=l.RepeatWrapping,e.anisotropy=4,e.repeat.set(t,t),e}))},p=function(e){return d(f.a,e)},g={uniforms:{},vertexShader:["attribute vec3 color;","varying vec3 col;","void main()","{","   col = color;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["in vec3 col;","void main( void ) {","\tgl_FragColor = vec4(col.r,col.g,col.b,1.0);","}"].join("\n")};function b(e){switch(e.name){case a.WATER:return c.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!0,color:16711680});case a.SAND:return c.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!1,color:16777215,side:l.DoubleSide,metalness:.2,bumpScale:5e-4,map:(t=e.repeat,d(s.a,t)),normalMap:p(e.repeat)});case a.SHADCOL:return c.a.createElement("shaderMaterial",{attach:"material",vertexShader:g.vertexShader,fragmentShader:g.fragmentShader})}var t}!function(e){e[e.WATER=0]="WATER",e[e.SAND=1]="SAND",e[e.SHADCOL=2]="SHADCOL"}(a||(a={}));var v=n(40),E=n(46),j=n(47),x=n(39);Object(i.b)({OrbitControls:E.a}),Object(i.b)({TransformControls:j.a});var O=function(e){var t=Object(i.e)().gl;return t.setClearColor(0),t.shadowMap.enabled=!0,t.shadowMap.type=l.PCFSoftShadowMap,c.a.createElement(c.a.Fragment,null)},y=function(){var e=Object(o.useRef)(),t=Object(i.e)(),n=t.camera,a=t.gl,r=Object(v.a)((function(e){return e.setControls}));return Object(i.c)((function(){e.current.update()})),Object(o.useEffect)((function(){r(e.current)}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("orbitControls",{ref:e,args:[n,a.domElement],enableDamping:!0,dampingFactor:.1,rotateSpeed:.5}))},w=function(e){var t=e.onChange,n=e.object,a=Object(v.a)((function(e){return e.controls})),r=Object(o.useRef)(),l=Object(i.e)(),u=l.camera,s=l.gl,m=function(e){t&&t(e.target.object.matrix)};return Object(o.useEffect)((function(){r.current.addEventListener("dragging-changed",(function(e){return a.enabled=!e.value})),console.log("attach controled object"),r.current.attach(n),r.current.addEventListener("dragging-changed",m)}),[]),Object(o.useEffect)((function(){return function(){console.log("detach controled object"),r.current.detach(),r.current.removeEventListener("dragging-changed",m)}}),[]),c.a.createElement("transformControls",{ref:r,args:[u,s.domElement]})},S=function(e){var t=Object(o.useRef)();return Object(i.c)((function(e){var n=e.clock.getElapsedTime();t.current.position.x=50*Math.sin(n/2),t.current.position.z=50*Math.cos(n/2)})),c.a.createElement(c.a.Fragment,null,c.a.createElement("spotLight",{ref:t,intensity:1,position:[30,30,50],angle:.2,penumbra:1,castShadow:!0}))},C=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("gridHelper",{args:[e.size,10]}),c.a.createElement("axesHelper",{args:[e.size/2]}))},M=function(){var e=[],t=c.a.createElement("mesh",{"rotation-x":Math.PI/2,receiveShadow:!0},c.a.createElement("planeGeometry",{attach:"geometry",args:[50,50]}),c.a.createElement(b,{name:a.SAND,repeat:1}));return e.push(t),c.a.createElement(c.a.Fragment,null,c.a.createElement("group",null,e),";")},A=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],l=t[1],i=Object(o.useRef)(),u=Object(o.useRef)(),s=Object(o.useCallback)((function(e){e.stopPropagation(),l(!i.current)}),[]);Object(o.useEffect)((function(){i.current=n}));var m=Object(o.useMemo)((function(){return c.a.createElement("mesh",{ref:u,position:[0,0,0],castShadow:!0,onClick:function(e){return s(e)}},c.a.createElement("boxBufferGeometry",{attach:"geometry",args:[10,10,10]}),c.a.createElement(b,{name:a.SAND,repeat:1}))}),[]),f=n?c.a.createElement(w,{onChange:null,object:u.current}):"";return c.a.createElement(c.a.Fragment,null,m,f)};t.default=function(e){var t=e.sample;return c.a.createElement(c.a.Fragment,null,c.a.createElement(x.b,{sample:t}),c.a.createElement(i.a,{gl2:!0,camera:{position:[15,30,50]}},c.a.createElement(O,null),c.a.createElement(S,null),c.a.createElement(C,{size:128}),c.a.createElement(y,null),c.a.createElement(M,null),c.a.createElement(A,null)))}},43:function(e,t,n){e.exports=n.p+"static/media/sand.be1ebb92.jpg"},44:function(e,t,n){e.exports=n.p+"static/media/sand_norm.3d153e6a.png"},45:function(e,t,n){},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a,r=n(16),o=n(15),c=n(0),l=n.n(c),i=n(38),u=n(42);!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTI=1]="MULTI",e[e.DRAG=2]="DRAG",e[e.DRAGMULTI=3]="DRAGMULTI",e[e.ALLORNOT=4]="ALLORNOT"}(a||(a={}));var s={default:{color:"white",alpha:.2,ghostColor:"white",ghostAlpha:0},hovered:{color:"white",alpha:.5,ghostColor:"brown",ghostAlpha:.2},selected:{color:"orange",alpha:.8,ghostColor:"green",ghostAlpha:.4}},m=function(e){var t=e.boxEnt,n=e.onClick,a=void 0===n?function(){}:n,m=e.onChange,f=void 0===m?function(){}:m,h=e.boxStyle,d=void 0===h?s:h,p=Object(c.useState)(!0),g=Object(o.a)(p,2),b=g[0],v=g[1],E=Object(c.useRef)(),j=Object(c.useRef)(),x=new i.Vector3;t.box.getSize(x);var O=new i.Vector3;t.box.getCenter(O);var y=Object(r.a)({},s);Object.assign(y,d);var w=t.selected?y.selected.color:y.default.color,S=t.selected?y.selected.alpha:b?y.hovered.alpha:y.default.alpha,C=t.selected?y.selected.ghostColor:y.default.ghostColor,M=t.selected?y.selected.ghostAlpha:b?y.hovered.ghostAlpha:y.default.ghostAlpha,A=function(e,t){e.stopPropagation(),v(t)};Object(c.useEffect)((function(){E.current.setFromObject(j.current)}));var k=t.selected&&j.current?l.a.createElement(u.MoveCtrl,{onChange:f,object:j.current}):"";return l.a.createElement(l.a.Fragment,null,l.a.createElement("boxHelper",{ref:E},l.a.createElement("lineBasicMaterial",{attach:"material",color:new i.Color(w),transparent:!0,opacity:S})),l.a.createElement("mesh",{ref:j,attach:"object",position:O,onPointerUp:function(e){return a(e)},onPointerOver:function(e){return A(e,!0)},onPointerOut:function(e){return A(e,!1)},onWheel:function(){return console.log("wheel")}},l.a.createElement("boxBufferGeometry",{attach:"geometry",args:x.toArray()}),l.a.createElement("meshStandardMaterial",{attach:"material",color:C,transparent:!0,opacity:M})),k)}},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(48),r=n(50);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=n(38),l=function(){function e(){Object(r.a)(this,e),this.rejected=[]}var t,n,l;return t=e,l=[{key:"checkValidity",value:function(t,n){var a=t.reduce((function(e,t){var n=new c.Vector3;return t.getSize(n),e+n.x*n.y*n.z}),0);return Math.round(a)===Math.round(n)?t:(this.rejected||(this.rejected=[]),e.checkDuplicate(t,this.rejected)&&this.rejected.push(t),null)}},{key:"makeCombinations",value:function(t,n,r,o){var c=n.filter((function(e){return-1===t.findIndex((function(t){return t.containsBox(e)||t.clone().expandByScalar(-.01).intersectsBox(e)}))}));if(c&&c.length){var l=[],i=c.find((function(n,i){return null!==(l=e.makeCombinations([].concat(Object(a.a)(t),[n]),c,r,o+1))}));return i?[i].concat(Object(a.a)(l)):null}return this.checkValidity(t,r)?[]:null}},{key:"checkIntersections",value:function(e){var t=new c.Vector3(0);return e.getSize(t),Math.min.apply(Math,Object(a.a)(t.toArray()))}},{key:"checkDuplicate",value:function(e,t){return!t.find((function(t){var n=!0;return e.forEach((function(e){var a=t.find((function(t){return t.equals(e)}));n=n&&a})),n}))}},{key:"split",value:function(t,n){if(n.filter((function(e){return!t.intersectsBox(e)})).length)return console.log("NOT all boxes are overlapping => don't go further"),[];var r=[t].concat(Object(a.a)(n)).map((function(e){var t=[];return t.push(e.min.clone()),t.push(new c.Vector3(e.max.x,e.min.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.max.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.max.y,e.min.z)),t.push(e.max.clone()),t.push(new c.Vector3(e.min.x,e.max.y,e.max.z)),t})).flat().reduce((function(e,t){var n=e.findIndex((function(e){return t.equals(e)}));return-1===n?[].concat(Object(a.a)(e),[t]):(e.splice(n,1),e)}),[]),o=[];r.forEach((function(e,t){r.slice(t).filter((function(t){return e.x!==t.x&&e.y!==t.y&&e.z!==t.z})).forEach((function(t){var a=new c.Box3;a.expandByPoint(e),a.expandByPoint(t),n.find((function(e){return a.intersectsBox(e.clone().expandByScalar(-.1))}))||o.push(a)}))}));var l=new c.Vector3;t.getSize(l);var i=l.x*l.y*l.z,u=n.reduce((function(e,t){return t.getSize(l),e-l.x*l.y*l.z}),i),s=[];o.forEach((function(t){var n=e.makeCombinations([t],o,u,0);n&&(n=[t].concat(Object(a.a)(n)),e.checkDuplicate(n,s)&&s.push(n))})),s.sort((function(e,t){return e.length-t.length}));var m=s[0];return m||(console.log("WARN No split found for intersection of "),console.log(t),console.log("with boxes: "),console.log(n),console.log("DEBUG => rejected combination:"),console.log(this.rejected),null)}},{key:"getRejected",value:function(){return this.rejected}}],(n=null)&&o(t.prototype,n),l&&o(t,l),e}();l.rejected=void 0},71:function(e,t,n){"use strict";n.r(t);var a=n(16),r=n(48),o=n(15),c=n(0),l=n.n(c),i=n(38),u=n(52),s=n(41),m=n(51),f=n(40),h=n(39),d=n(42),p={default:{color:"white",alpha:.4,ghostColor:"white",ghostAlpha:0},hovered:{color:"orange",alpha:.4,ghostColor:"white",ghostAlpha:0}},g={selected:{color:"white",alpha:.6,ghostColor:"white",ghostAlpha:.1}},b={default:{color:"red",alpha:1,ghostColor:"red",ghostAlpha:.1}},v={default:{color:"green",alpha:1,ghostColor:"green",ghostAlpha:.1}},E=new i.Vector3(0,0,0),j=new i.Vector3(20,30,40),x=new i.Vector3(50,50,50),O=new i.Vector3(51,51,25),y=new i.Box3(E,x),w=new i.Box3(j,j.clone().add(O)),S=function(){var e=Object(f.a)((function(e){return e.time})),t=Object(f.a)((function(e){return e.setTime}));return Object(c.useEffect)((function(){t(new Date(0))}),[]),l.a.createElement(l.a.Fragment,null,e.custom?l.a.createElement("span",{className:"overlay",id:"timeinfo"},"Custom Time (SPACE key to toggle anim) ",e.custom.toLocaleTimeString(),"  "):"")},C=function(){var e=Object(f.a)((function(e){return e.time})),t=Object(f.a)((function(e){return e.setTime})),n=Object(s.e)().clock,h=Object(c.useRef)(!1),d=Object(c.useState)([]),E=Object(o.a)(d,2),j=E[0],x=E[1],O={box:y,selected:!1},S={box:w,selected:!0},C=function(e){var t=S.box,n=new i.Vector3(0,0,0);t.getSize(n);var a=new i.Vector3;if(a.applyMatrix4(e),S.box.setFromCenterAndSize(a,n),t.intersectsBox(y)){var o=t.clone().intersect(y),c=u.a.split(y,[o]);x([o].concat(Object(r.a)(c)))}return{}};Object(s.c)((function(){var e=n.getElapsedTime(),a=new Date(0);a.setHours(Math.floor(e)%24),a.setMinutes(Math.floor(60*(e-Math.floor(e)))),h.current&&t(a)})),Object(c.useEffect)((function(){var t=new i.Matrix4,n=new i.Vector3(0,0,0);y.getCenter(n);var a=new i.Vector3(0,0,0);w.getCenter(a);var r=60*e.custom.getHours()+e.custom.getMinutes();t.makeTranslation(n.x/2*(1+2*Math.cos(2*Math.PI*r/1440)),25*(1+2*Math.sin(2*Math.PI*r/1440)),a.z),C(t)}),[e]),Object(c.useEffect)((function(){window.addEventListener("keydown",(function(e){"Space"===e.code&&(h.current=!h.current)}),!1)}),[]);var M=[l.a.createElement(m.a,{key:0,boxEnt:O,boxStyle:p}),l.a.createElement(m.a,{key:1,boxEnt:S,onChange:C,boxStyle:g})],A=j.map((function(e,t){var n={box:e,selected:!1},r=t?v:b;return l.a.createElement(m.a,{key:t+2,boxEnt:n,boxStyle:Object(a.a)({},r)})}));return l.a.createElement(l.a.Fragment,null,M,A)};t.default=function(e){var t=e.sample;return l.a.createElement(l.a.Fragment,null,l.a.createElement(S,null),l.a.createElement(h.b,{sample:t}),l.a.createElement(s.a,{camera:{position:[100,50,100]}},l.a.createElement("ambientLight",{intensity:.5}),l.a.createElement(d.Wrapper,null),l.a.createElement(d.Controls,null),l.a.createElement(C,null)))}}}]);
//# sourceMappingURL=5.7cd7db9c.chunk.js.map