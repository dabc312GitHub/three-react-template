(this["webpackJsonpthree-react-sandbox"]=this["webpackJsonpthree-react-sandbox"]||[]).push([[4,8],{39:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(0),a=n.n(r),o=(n(45),function(e){var t=e.sample;return console.log("Sample: %s %s",t.name,t.caseNb?"#"+t.caseNb:""),a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"overlay",id:"info"},a.a.createElement("span",null,t.name)))}),c=function(e){var t=e.items,n=e.current,r=e.onSelect;return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"overlay inputBtn",id:"caseSelector"},a.a.createElement("select",{id:"testCases",value:n,onChange:function(e){return r(e.target.value)}},Object.keys(t).map((function(e){return a.a.createElement("option",{key:e,value:e},t[e])})))))}},40:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(16),a=n(15),o=n(49),c=Object(o.a)((function(e,t){return{time:{custom:new Date},controls:{},setTime:function(n){e(Object(r.a)({},t(),{time:{custom:n}}))},setControls:function(n){return e(Object(r.a)({},t(),{controls:n}))}}})),l=Object(a.a)(c,1)[0]},42:function(e,t,n){"use strict";n.r(t),n.d(t,"Wrapper",(function(){return O})),n.d(t,"Controls",(function(){return w})),n.d(t,"MoveCtrl",(function(){return y})),n.d(t,"Lights",(function(){return S})),n.d(t,"Helpers",(function(){return C}));var r,a=n(15),o=n(0),c=n.n(o),l=n(38),i=n(41),u=n(43),s=n.n(u),m=n(44),f=n.n(m),p=new l.TextureLoader,d=function(e,t){return p.load(e,(function(e){return e.wrapS=l.RepeatWrapping,e.wrapT=l.RepeatWrapping,e.anisotropy=4,e.repeat.set(t,t),e}))},h=function(e){return d(f.a,e)},g={uniforms:{},vertexShader:["attribute vec3 color;","varying vec3 col;","void main()","{","   col = color;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["in vec3 col;","void main( void ) {","\tgl_FragColor = vec4(col.r,col.g,col.b,1.0);","}"].join("\n")};function v(e){switch(e.name){case r.WATER:return c.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!0,color:16711680});case r.SAND:return c.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!1,color:16777215,side:l.DoubleSide,metalness:.2,bumpScale:5e-4,map:(t=e.repeat,d(s.a,t)),normalMap:h(e.repeat)});case r.SHADCOL:return c.a.createElement("shaderMaterial",{attach:"material",vertexShader:g.vertexShader,fragmentShader:g.fragmentShader})}var t}!function(e){e[e.WATER=0]="WATER",e[e.SAND=1]="SAND",e[e.SHADCOL=2]="SHADCOL"}(r||(r={}));var b=n(40),E=n(46),x=n(47),j=n(39);Object(i.b)({OrbitControls:E.a}),Object(i.b)({TransformControls:x.a});var O=function(e){var t=Object(i.e)().gl;return t.setClearColor(0),t.shadowMap.enabled=!0,t.shadowMap.type=l.PCFSoftShadowMap,c.a.createElement(c.a.Fragment,null)},w=function(){var e=Object(o.useRef)(),t=Object(i.e)(),n=t.camera,r=t.gl,a=Object(b.a)((function(e){return e.setControls}));return Object(i.c)((function(){e.current.update()})),Object(o.useEffect)((function(){a(e.current)}),[]),c.a.createElement(c.a.Fragment,null,c.a.createElement("orbitControls",{ref:e,args:[n,r.domElement],enableDamping:!0,dampingFactor:.1,rotateSpeed:.5}))},y=function(e){var t=e.onChange,n=e.object,r=Object(b.a)((function(e){return e.controls})),a=Object(o.useRef)(),l=Object(i.e)(),u=l.camera,s=l.gl,m=function(e){t&&t(e.target.object.matrix)};return Object(o.useEffect)((function(){a.current.addEventListener("dragging-changed",(function(e){return r.enabled=!e.value})),console.log("attach controled object"),a.current.attach(n),a.current.addEventListener("dragging-changed",m)}),[]),Object(o.useEffect)((function(){return function(){console.log("detach controled object"),a.current.detach(),a.current.removeEventListener("dragging-changed",m)}}),[]),c.a.createElement("transformControls",{ref:a,args:[u,s.domElement]})},S=function(e){var t=Object(o.useRef)();return Object(i.c)((function(e){var n=e.clock.getElapsedTime();t.current.position.x=50*Math.sin(n/2),t.current.position.z=50*Math.cos(n/2)})),c.a.createElement(c.a.Fragment,null,c.a.createElement("spotLight",{ref:t,intensity:1,position:[30,30,50],angle:.2,penumbra:1,castShadow:!0}))},C=function(e){return c.a.createElement(c.a.Fragment,null,c.a.createElement("gridHelper",{args:[e.size,10]}),c.a.createElement("axesHelper",{args:[e.size/2]}))},A=function(){var e=[],t=c.a.createElement("mesh",{"rotation-x":Math.PI/2,receiveShadow:!0},c.a.createElement("planeGeometry",{attach:"geometry",args:[50,50]}),c.a.createElement(v,{name:r.SAND,repeat:1}));return e.push(t),c.a.createElement(c.a.Fragment,null,c.a.createElement("group",null,e),";")},B=function(){var e=Object(o.useState)(!1),t=Object(a.a)(e,2),n=t[0],l=t[1],i=Object(o.useRef)(),u=Object(o.useRef)(),s=Object(o.useCallback)((function(e){e.stopPropagation(),l(!i.current)}),[]);Object(o.useEffect)((function(){i.current=n}));var m=Object(o.useMemo)((function(){return c.a.createElement("mesh",{ref:u,position:[0,0,0],castShadow:!0,onClick:function(e){return s(e)}},c.a.createElement("boxBufferGeometry",{attach:"geometry",args:[10,10,10]}),c.a.createElement(v,{name:r.SAND,repeat:1}))}),[]),f=n?c.a.createElement(y,{onChange:null,object:u.current}):"";return c.a.createElement(c.a.Fragment,null,m,f)};t.default=function(e){var t=e.sample;return c.a.createElement(c.a.Fragment,null,c.a.createElement(j.b,{sample:t}),c.a.createElement(i.a,{gl2:!0,camera:{position:[15,30,50]}},c.a.createElement(O,null),c.a.createElement(S,null),c.a.createElement(C,{size:128}),c.a.createElement(w,null),c.a.createElement(A,null),c.a.createElement(B,null)))}},43:function(e,t,n){e.exports=n.p+"static/media/sand.be1ebb92.jpg"},44:function(e,t,n){e.exports=n.p+"static/media/sand_norm.3d153e6a.png"},45:function(e,t,n){},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,a=n(16),o=n(15),c=n(0),l=n.n(c),i=n(38),u=n(42);!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTI=1]="MULTI",e[e.DRAG=2]="DRAG",e[e.DRAGMULTI=3]="DRAGMULTI",e[e.ALLORNOT=4]="ALLORNOT"}(r||(r={}));var s={default:{color:"white",alpha:.2,ghostColor:"white",ghostAlpha:0},hovered:{color:"white",alpha:.5,ghostColor:"brown",ghostAlpha:.2},selected:{color:"orange",alpha:.8,ghostColor:"green",ghostAlpha:.4}},m=function(e){var t=e.boxEnt,n=e.onClick,r=void 0===n?function(){}:n,m=e.onChange,f=void 0===m?function(){}:m,p=e.boxStyle,d=void 0===p?s:p,h=Object(c.useState)(!0),g=Object(o.a)(h,2),v=g[0],b=g[1],E=Object(c.useRef)(),x=Object(c.useRef)(),j=new i.Vector3;t.box.getSize(j);var O=new i.Vector3;t.box.getCenter(O);var w=Object(a.a)({},s);Object.assign(w,d);var y=t.selected?w.selected.color:w.default.color,S=t.selected?w.selected.alpha:v?w.hovered.alpha:w.default.alpha,C=t.selected?w.selected.ghostColor:w.default.ghostColor,A=t.selected?w.selected.ghostAlpha:v?w.hovered.ghostAlpha:w.default.ghostAlpha,B=function(e,t){e.stopPropagation(),b(t)};Object(c.useEffect)((function(){E.current.setFromObject(x.current)}));var V=t.selected&&x.current?l.a.createElement(u.MoveCtrl,{onChange:f,object:x.current}):"";return l.a.createElement(l.a.Fragment,null,l.a.createElement("boxHelper",{ref:E},l.a.createElement("lineBasicMaterial",{attach:"material",color:new i.Color(y),transparent:!0,opacity:S})),l.a.createElement("mesh",{ref:x,attach:"object",position:O,onPointerUp:function(e){return r(e)},onPointerOver:function(e){return B(e,!0)},onPointerOut:function(e){return B(e,!1)},onWheel:function(){return console.log("wheel")}},l.a.createElement("boxBufferGeometry",{attach:"geometry",args:j.toArray()}),l.a.createElement("meshStandardMaterial",{attach:"material",color:C,transparent:!0,opacity:A})),V)}},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(48),a=n(50);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=n(38),l=function(){function e(){Object(a.a)(this,e),this.rejected=[]}var t,n,l;return t=e,l=[{key:"checkValidity",value:function(t,n){var r=t.reduce((function(e,t){var n=new c.Vector3;return t.getSize(n),e+n.x*n.y*n.z}),0);return Math.round(r)===Math.round(n)?t:(this.rejected||(this.rejected=[]),e.checkDuplicate(t,this.rejected)&&this.rejected.push(t),null)}},{key:"makeCombinations",value:function(t,n,a,o){var c=n.filter((function(e){return-1===t.findIndex((function(t){return t.containsBox(e)||t.clone().expandByScalar(-.01).intersectsBox(e)}))}));if(c&&c.length){var l=[],i=c.find((function(n,i){return null!==(l=e.makeCombinations([].concat(Object(r.a)(t),[n]),c,a,o+1))}));return i?[i].concat(Object(r.a)(l)):null}return this.checkValidity(t,a)?[]:null}},{key:"checkIntersections",value:function(e){var t=new c.Vector3(0);return e.getSize(t),Math.min.apply(Math,Object(r.a)(t.toArray()))}},{key:"checkDuplicate",value:function(e,t){return!t.find((function(t){var n=!0;return e.forEach((function(e){var r=t.find((function(t){return t.equals(e)}));n=n&&r})),n}))}},{key:"split",value:function(t,n){if(n.filter((function(e){return!t.intersectsBox(e)})).length)return console.log("NOT all boxes are overlapping => don't go further"),[];var a=[t].concat(Object(r.a)(n)).map((function(e){var t=[];return t.push(e.min.clone()),t.push(new c.Vector3(e.max.x,e.min.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.max.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.max.y,e.min.z)),t.push(e.max.clone()),t.push(new c.Vector3(e.min.x,e.max.y,e.max.z)),t})).flat().reduce((function(e,t){var n=e.findIndex((function(e){return t.equals(e)}));return-1===n?[].concat(Object(r.a)(e),[t]):(e.splice(n,1),e)}),[]),o=[];a.forEach((function(e,t){a.slice(t).filter((function(t){return e.x!==t.x&&e.y!==t.y&&e.z!==t.z})).forEach((function(t){var r=new c.Box3;r.expandByPoint(e),r.expandByPoint(t),n.find((function(e){return r.intersectsBox(e.clone().expandByScalar(-.1))}))||o.push(r)}))}));var l=new c.Vector3;t.getSize(l);var i=l.x*l.y*l.z,u=n.reduce((function(e,t){return t.getSize(l),e-l.x*l.y*l.z}),i),s=[];o.forEach((function(t){var n=e.makeCombinations([t],o,u,0);n&&(n=[t].concat(Object(r.a)(n)),e.checkDuplicate(n,s)&&s.push(n))})),s.sort((function(e,t){return e.length-t.length}));var m=s[0];return m||(console.log("WARN No split found for intersection of "),console.log(t),console.log("with boxes: "),console.log(n),console.log("DEBUG => rejected combination:"),console.log(this.rejected),null)}},{key:"getRejected",value:function(){return this.rejected}}],(n=null)&&o(t.prototype,n),l&&o(t,l),e}();l.rejected=void 0},72:function(e,t,n){"use strict";n.r(t);var r=n(15),a=n(0),o=n.n(a),c=n(51),l=n(38),i=n(52),u=n(42),s=n(39),m=n(41),f={default:{color:"red",alpha:1,ghostColor:"red",ghostAlpha:.1}},p={default:{color:"green",alpha:1,ghostColor:"green",ghostAlpha:.1}},d=function(e){var t=e.initBoxes,n=e.splitBoxes,r=t.map((function(e,t){var n={box:e,selected:!1};return o.a.createElement(c.a,{boxEnt:n,boxStyle:f})})),a=n.map((function(e,t){var n={box:e,selected:!1};return o.a.createElement(c.a,{boxEnt:n,boxStyle:p})}));return o.a.createElement(o.a.Fragment,null,r,a)},h=[function(){var e,t;e=new l.Vector3(0,0,-15),t=new l.Vector3(50,50,15);var n=new l.Box3(e,t);e=new l.Vector3(0,0,30),t=new l.Vector3(50,50,60);var r=new l.Box3(e,t),a=i.a.split(n,[r.clone().intersect(n)]);return o.a.createElement(d,{initBoxes:[n,r],splitBoxes:a})},function(){var e,t;e=new l.Vector3(-30,0,0),t=new l.Vector3(15,50,50);var n=new l.Box3(e,t);e=new l.Vector3(0,0,0),t=new l.Vector3(45,50,50);var r=new l.Box3(e,t),a=i.a.split(n,[r.intersect(n)]);return o.a.createElement(d,{initBoxes:[n,r],splitBoxes:a})},function(){var e,t;e=new l.Vector3(-92,-16,36),t=new l.Vector3(-36,80,92);var n=new l.Box3(e,t);e=new l.Vector3(-92,-6.399999999999999,36),t=new l.Vector3(-36,70.4,92);var r=new l.Box3(e,t),a=i.a.split(n,[r.intersect(n)]);return o.a.createElement(d,{initBoxes:[n,r],splitBoxes:a})}];t.default=function(e){var t=e.sample,n=Object(a.useState)(0),c=Object(r.a)(n,2),l=c[0],i=c[1];Object(a.useEffect)((function(){void 0!==t.case&&null!==t.case&&""!==t.case&&i(t.case)}),[]);var f=h[l];return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.b,{sample:t}),o.a.createElement(s.a,{items:h.map((function(e){return e.name})),current:l,onSelect:function(e){console.log("switch case to: "+e),i(parseInt(e))}}),o.a.createElement(m.a,{camera:{position:[100,50,100]}},o.a.createElement("ambientLight",{intensity:2}),o.a.createElement(u.Wrapper,null),o.a.createElement(u.Helpers,{size:128}),o.a.createElement(u.Controls,null),o.a.createElement(f,null)))}}}]);
//# sourceMappingURL=4.82abda43.chunk.js.map