(this["webpackJsonpthree-react-sandbox"]=this["webpackJsonpthree-react-sandbox"]||[]).push([[4,8],{41:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return l}));var a=n(0),r=n.n(a),o=n(17),c=(n(45),function(e){var t=e.sample;return console.log("Sample: %s %s",t.name,t.caseNb?"#"+t.caseNb:""),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"overlay",id:"info"},r.a.createElement("span",null,t.name)))}),l=function(e){var t=e.sampleCases,n=e.caseId,a=Object(o.a)((function(e){return e.setSample}));return console.log("switch to case #"+t[n].name),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"overlay",id:"caseSelector"},r.a.createElement("select",{id:"testCases",value:n,onChange:function(e){return a({caseNb:e.target.value})}},Object.keys(t).map((function(e){return r.a.createElement("option",{key:e,value:e},t[e].name)})))))}},43:function(e,t,n){e.exports=n.p+"static/media/sand.be1ebb92.jpg"},44:function(e,t,n){e.exports=n.p+"static/media/sand_norm.3d153e6a.png"},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t),n.d(t,"Wrapper",(function(){return j})),n.d(t,"Controls",(function(){return w})),n.d(t,"Lights",(function(){return y})),n.d(t,"Helpers",(function(){return O}));var a,r=n(0),o=n.n(r),c=n(40),l=n(42),i=n(43),u=n.n(i),s=n(44),m=n.n(s),f=new c.TextureLoader,p=function(e,t){return f.load(e,(function(e){return e.wrapS=c.RepeatWrapping,e.wrapT=c.RepeatWrapping,e.anisotropy=4,e.repeat.set(t,t),e}))},d=function(e){return p(m.a,e)},h={uniforms:{},vertexShader:["attribute vec3 color;","varying vec3 col;","void main()","{","   col = color;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["in vec3 col;","void main( void ) {","\tgl_FragColor = vec4(col.r,col.g,col.b,1.0);","}"].join("\n")};function g(e){switch(e.name){case a.WATER:return o.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!0,color:16711680});case a.SAND:return o.a.createElement("meshStandardMaterial",{attach:"material",opacity:.5,transparent:!1,color:16777215,side:c.DoubleSide,metalness:.2,bumpScale:5e-4,map:(t=e.repeat,p(u.a,t)),normalMap:d(e.repeat)});case a.SHADCOL:return o.a.createElement("shaderMaterial",{attach:"material",vertexShader:h.vertexShader,fragmentShader:h.fragmentShader})}var t}!function(e){e[e.WATER=0]="WATER",e[e.SAND=1]="SAND",e[e.SHADCOL=2]="SHADCOL"}(a||(a={}));var v=n(17),b=n(47),E=n(48),x=n(41);Object(l.b)({OrbitControls:b.a}),Object(l.b)({TransformControls:E.a});var j=function(e){var t=Object(l.e)().gl;return t.setClearColor(0),t.shadowMap.enabled=!0,t.shadowMap.type=c.PCFSoftShadowMap,o.a.createElement(o.a.Fragment,null)},w=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(l.e)(),a=n.camera,c=n.gl,i=Object(v.a)((function(e){return e.setTransfCtrl}));return Object(l.c)((function(){e.current.update()})),Object(r.useEffect)((function(){i(t.current),t.current.addEventListener("dragging-changed",(function(t){return e.current.enabled=!t.value}))}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement("orbitControls",{ref:e,args:[a,c.domElement],enableDamping:!0,dampingFactor:.1,rotateSpeed:.5}),o.a.createElement("transformControls",{ref:t,args:[a,c.domElement]}))},y=function(e){var t=Object(r.useRef)();return Object(l.c)((function(e){var n=e.clock.getElapsedTime();t.current.position.x=50*Math.sin(n/2),t.current.position.z=50*Math.cos(n/2)})),o.a.createElement(o.a.Fragment,null,o.a.createElement("spotLight",{ref:t,intensity:1,position:[30,30,50],angle:.2,penumbra:1,castShadow:!0}))},O=function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement("gridHelper",{args:[e.size,10]}),o.a.createElement("axesHelper",{args:[e.size/2]}))},S=function(){var e=[],t=o.a.createElement("mesh",{"rotation-x":Math.PI/2,receiveShadow:!0},o.a.createElement("planeGeometry",{attach:"geometry",args:[50,50]}),o.a.createElement(g,{name:a.SAND,repeat:1}));return e.push(t),o.a.createElement(o.a.Fragment,null,o.a.createElement("group",null,e),";")},C=function(){var e=Object(v.a)((function(e){return e.transfCtrl})),t=Object(r.useCallback)((function(t){t.stopPropagation(),e.attach(t.object)}),[e]),n=[],c=o.a.createElement("mesh",{position:[0,0,0],castShadow:!0,onClick:function(e){return t(e)}},o.a.createElement("boxBufferGeometry",{attach:"geometry",args:[10,10,10]}),o.a.createElement(g,{name:a.SAND,repeat:1}));return n.push(c),o.a.createElement(o.a.Fragment,null,o.a.createElement("group",null,n),";")};t.default=function(e){var t=e.sample;return o.a.createElement(o.a.Fragment,null,o.a.createElement(x.b,{sample:t}),o.a.createElement(l.a,{gl2:!0,camera:{position:[15,30,50]}},o.a.createElement(j,null),o.a.createElement(y,null),o.a.createElement(O,{size:128}),o.a.createElement(w,null),o.a.createElement(S,null),o.a.createElement(C,null)))}},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a,r=n(6),o=n(9),c=n(0),l=n.n(c),i=n(40),u=n(17);!function(e){e[e.SINGLE=0]="SINGLE",e[e.MULTI=1]="MULTI",e[e.DRAG=2]="DRAG",e[e.DRAGMULTI=3]="DRAGMULTI",e[e.ALLORNOT=4]="ALLORNOT"}(a||(a={}));var s={default:{color:"white",alpha:.2,ghostColor:"white",ghostAlpha:0},hovered:{color:"white",alpha:.5,ghostColor:"brown",ghostAlpha:.2},selected:{color:"orange",alpha:.8,ghostColor:"green",ghostAlpha:.4}},m=function(e){var t=e.boxEnt,n=e.onClick,a=void 0===n?function(){}:n,u=e.onChange,m=void 0===u?function(){}:u,p=e.boxStyle,d=void 0===p?s:p,h=Object(c.useState)(!0),g=Object(o.a)(h,2),v=g[0],b=g[1],E=Object(c.useRef)(),x=Object(c.useRef)(),j=new i.Vector3;t.box.getSize(j);var w=new i.Vector3;t.box.getCenter(w);var y=Object(r.a)({},s);Object.assign(y,d);var O=t.selected?y.selected.color:y.default.color,S=t.selected?y.selected.alpha:v?y.hovered.alpha:y.default.alpha,C=t.selected?y.selected.ghostColor:y.default.ghostColor,A=t.selected?y.selected.ghostAlpha:v?y.hovered.ghostAlpha:y.default.ghostAlpha,B=function(e,t){e.stopPropagation(),b(t)};Object(c.useEffect)((function(){E.current.setFromObject(x.current)}));var V=t.selected&&x.current?l.a.createElement(f,{onChange:m,object:x.current}):"";return l.a.createElement(l.a.Fragment,null,V,l.a.createElement("boxHelper",{ref:E},l.a.createElement("lineBasicMaterial",{attach:"material",color:new i.Color(O),transparent:!0,opacity:S})),l.a.createElement("mesh",{ref:x,attach:"object",position:w,onPointerUp:function(e){return a(e)},onPointerOver:function(e){return B(e,!0)},onPointerOut:function(e){return B(e,!1)},onWheel:function(){return console.log("wheel")}},l.a.createElement("boxBufferGeometry",{attach:"geometry",args:j.toArray()}),l.a.createElement("meshStandardMaterial",{attach:"material",color:C,transparent:!0,opacity:A})))},f=function(e){var t=e.onChange,n=e.object,a=Object(u.a)((function(e){return e.transfCtrl})),r=function(e){t(e.target.object.matrix)};return Object(c.useEffect)((function(){a.enabled&&(console.log("attach controled object"),a.attach(n),a.addEventListener("dragging-changed",r))}),[a]),Object(c.useEffect)((function(){return function(){console.log("detach controled object"),a.detach(),a.removeEventListener("dragging-changed",r)}}),[]),l.a.createElement(l.a.Fragment,null)}},52:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(49),r=n(50);function o(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var c=n(40),l=function(){function e(){Object(r.a)(this,e),this.rejected=[]}var t,n,l;return t=e,l=[{key:"checkValidity",value:function(t,n){var a=t.reduce((function(e,t){var n=new c.Vector3;return t.getSize(n),e+n.x*n.y*n.z}),0);return Math.round(a)===Math.round(n)?t:(this.rejected||(this.rejected=[]),e.checkDuplicate(t,this.rejected)&&this.rejected.push(t),null)}},{key:"makeCombinations",value:function(t,n,r,o){var c=n.filter((function(e){return-1===t.findIndex((function(t){return t.containsBox(e)||t.clone().expandByScalar(-.01).intersectsBox(e)}))}));if(c&&c.length){var l=[],i=c.find((function(n,i){return null!==(l=e.makeCombinations([].concat(Object(a.a)(t),[n]),c,r,o+1))}));return i?[i].concat(Object(a.a)(l)):null}return this.checkValidity(t,r)?[]:null}},{key:"checkIntersections",value:function(e){var t=new c.Vector3(0);return e.getSize(t),Math.min.apply(Math,Object(a.a)(t.toArray()))}},{key:"checkDuplicate",value:function(e,t){return!t.find((function(t){var n=!0;return e.forEach((function(e){var a=t.find((function(t){return t.equals(e)}));n=n&&a})),n}))}},{key:"split",value:function(t,n){if(n.filter((function(e){return!t.intersectsBox(e)})).length)return console.log("NOT all boxes are overlapping => don't go further"),[];var r=[t].concat(Object(a.a)(n)).map((function(e){var t=[];return t.push(e.min.clone()),t.push(new c.Vector3(e.max.x,e.min.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.min.y,e.max.z)),t.push(new c.Vector3(e.min.x,e.max.y,e.min.z)),t.push(new c.Vector3(e.max.x,e.max.y,e.min.z)),t.push(e.max.clone()),t.push(new c.Vector3(e.min.x,e.max.y,e.max.z)),t})).flat().reduce((function(e,t){var n=e.findIndex((function(e){return t.equals(e)}));return-1===n?[].concat(Object(a.a)(e),[t]):(e.splice(n,1),e)}),[]),o=[];r.forEach((function(e,t){r.slice(t).filter((function(t){return e.x!==t.x&&e.y!==t.y&&e.z!==t.z})).forEach((function(t){var a=new c.Box3;a.expandByPoint(e),a.expandByPoint(t),n.find((function(e){return a.intersectsBox(e.clone().expandByScalar(-.1))}))||o.push(a)}))}));var l=new c.Vector3;t.getSize(l);var i=l.x*l.y*l.z,u=n.reduce((function(e,t){return t.getSize(l),e-l.x*l.y*l.z}),i),s=[];o.forEach((function(t){var n=e.makeCombinations([t],o,u,0);n&&(n=[t].concat(Object(a.a)(n)),e.checkDuplicate(n,s)&&s.push(n))})),s.sort((function(e,t){return e.length-t.length}));var m=s[0];return m||(console.log("WARN No split found for intersection of "),console.log(t),console.log("with boxes: "),console.log(n),console.log("DEBUG => rejected combination:"),console.log(this.rejected),null)}},{key:"getRejected",value:function(){return this.rejected}}],(n=null)&&o(t.prototype,n),l&&o(t,l),e}();l.rejected=void 0},70:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(51),c=n(40),l=n(52),i=n(46),u=n(41),s=n(42),m=n(17),f={default:{color:"red",alpha:1,ghostColor:"red",ghostAlpha:.1}},p={default:{color:"green",alpha:1,ghostColor:"green",ghostAlpha:.1}},d=function(e){var t=e.initBoxes,n=e.splitBoxes,a=t.map((function(e,t){var n={box:e,selected:!1};return r.a.createElement(o.a,{boxEnt:n,boxStyle:f})})),c=n.map((function(e,t){var n={box:e,selected:!1};return r.a.createElement(o.a,{boxEnt:n,boxStyle:p})}));return r.a.createElement(r.a.Fragment,null,a,c)},h=[function(){var e,t;e=new c.Vector3(0,0,-15),t=new c.Vector3(50,50,15);var n=new c.Box3(e,t);e=new c.Vector3(0,0,30),t=new c.Vector3(50,50,60);var a=new c.Box3(e,t),o=l.a.split(n,[a.clone().intersect(n)]);return r.a.createElement(d,{initBoxes:[n,a],splitBoxes:o})},function(){var e,t;e=new c.Vector3(-30,0,0),t=new c.Vector3(15,50,50);var n=new c.Box3(e,t);e=new c.Vector3(0,0,0),t=new c.Vector3(45,50,50);var a=new c.Box3(e,t),o=l.a.split(n,[a.intersect(n)]);return r.a.createElement(d,{initBoxes:[n,a],splitBoxes:o})},function(){var e,t;e=new c.Vector3(-92,-16,36),t=new c.Vector3(-36,80,92);var n=new c.Box3(e,t);e=new c.Vector3(-92,-6.399999999999999,36),t=new c.Vector3(-36,70.4,92);var a=new c.Box3(e,t),o=l.a.split(n,[a.intersect(n)]);return r.a.createElement(d,{initBoxes:[n,a],splitBoxes:o})}];t.default=function(){var e=Object(m.a)((function(e){return e.sample})),t=void 0!==e.caseNb&&null!==e.caseNb&&""!==e.caseNb?e.caseNb:0,n=h[t];return r.a.createElement(r.a.Fragment,null,r.a.createElement(u.b,{sample:e}),r.a.createElement(u.a,{sampleCases:h,caseId:t}),r.a.createElement(s.a,{camera:{position:[100,50,100]}},r.a.createElement("ambientLight",{intensity:2}),r.a.createElement(i.Wrapper,null),r.a.createElement(i.Helpers,{size:128}),r.a.createElement(i.Controls,null),r.a.createElement(n,null)))}}}]);
//# sourceMappingURL=4.eeacbe5f.chunk.js.map